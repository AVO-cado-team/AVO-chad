
CREATE TABLE file (
                      id int8 generated by default as identity primary key ,
                      date timestamptz not null ,
                      name varchar(100) not null ,
                      path varchar(200) not null ,
                      type int not null
);

CREATE TABLE channel (
                         id int8 generated by default as identity primary key ,
                         title varchar(100) not null,
                         avatar_file_id int references file(id) null,
                         description varchar(1000) null,
                         default_permission int not null

);

CREATE TABLE person (
                        id int8 generated by default as identity primary key,
                        first_name varchar(50) not null ,
                        second_name varchar(120) not null ,
                        username varchar(120) not null ,
                        email varchar(125) not null ,
                        password varchar(120) not null ,
                        language_code varchar(20) not null,
                        avatar_file_id int references file(id) null,
                        status int not null
);

CREATE TABLE chat(
                     id int8 generated by default as identity primary key ,
                     title varchar(120) not null ,
                     chat_type int not null ,
                     description varchar(1000) null,
                     linked_chat_id int not null ,
                     has_private_forward bool not null ,
                     pinned_message_id int null,
                     avatar_file_id int references file(id) null,
                     channel_id int references channel(id) null

);

CREATE TABLE permission (
                            id int8 generated by default as identity primary key ,
                            chat_id int8 references chat(id) null,
                            channel_id int8 references channel(id) null,
                            person_id int8 references person(id) null,
                            permission int not null ,
                            date timestamptz not null ,
                            text varchar(200) null
);

CREATE TABLE message (
                         id int8 generated by default as identity primary key ,
                         person_id int8 references person(id) not null ,
                         file_id int8 references file(id) null,
                         chat_id int8 references chat(id) not null ,
                         message_id int not null ,
                         date timestamptz not null ,
                         text  varchar(2000) not null
);

CREATE TABLE person_chat (
    id int8 generated by default as identity primary key ,
    person_id int8 references person(id) not null ,
    chat_id int8 references chat(id) not null
);

CREATE TABLE channel_person (
    person_id int8 references person(id) not null ,
    channel_id int8 references channel(id) not null
);
